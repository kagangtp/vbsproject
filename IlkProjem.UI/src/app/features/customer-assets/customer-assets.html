<div class="assets-wrapper">
    <!-- Header -->
    <div class="assets-header">
        <button class="btn-back" (click)="goBack()">‚Üê {{ 'COMMON.BACK' | translate }}</button>
        <div class="customer-info" *ngIf="customer">
            <h1>{{ customer.name }}</h1>
            <p>{{ customer.email }}</p>
        </div>
    </div>

    <!-- Houses Section -->
    <div class="section">
        <div class="section-header">
            <h2>üè† {{ 'CUSTOMER_ASSETS_PAGE.HOUSES_TITLE' | translate }}</h2>
            <button class="btn-add" (click)="goAddHouse()">+ {{ 'CUSTOMER_ASSETS_PAGE.ADD_HOUSE' | translate }}</button>
        </div>

        <div class="cards-grid">
            @for (house of houses; track house.id) {
            <div class="asset-card">
                <div class="asset-card-header">
                    <span class="asset-badge">#{{ house.id }}</span>
                    <span class="asset-title">{{ house.address }}</span>
                    <button class="btn-edit" (click)="goEditHouse(house.id)">‚úèÔ∏è</button>
                </div>
                <p class="asset-desc" *ngIf="house.description">{{ house.description }}</p>
                <div class="images-row" *ngIf="house.images && house.images.length > 0">
                    @for (img of house.images; track img.id) {
                    <div class="image-thumb" (click)="openLightbox(img.relativePath, img.fileName)">
                        <img [src]="'http://localhost:5005/uploads/' + img.relativePath" [alt]="img.fileName"
                            loading="lazy" />
                    </div>
                    }
                </div>
                <div class="no-images" *ngIf="!house.images || house.images.length === 0">
                    <span>{{ 'CUSTOMER_ASSETS_PAGE.NO_IMAGES' | translate }}</span>
                </div>
            </div>
            } @empty {
            <div class="empty-section">
                <p>{{ 'CUSTOMER_ASSETS_PAGE.NO_HOUSES' | translate }}</p>
            </div>
            }
        </div>
    </div>

    <!-- Cars Section -->
    <div class="section">
        <div class="section-header">
            <h2>üöó {{ 'CUSTOMER_ASSETS_PAGE.CARS_TITLE' | translate }}</h2>
            <button class="btn-add" (click)="goAddCar()">+ {{ 'CUSTOMER_ASSETS_PAGE.ADD_CAR' | translate }}</button>
        </div>

        <div class="cards-grid">
            @for (car of cars; track car.id) {
            <div class="asset-card">
                <div class="asset-card-header">
                    <span class="asset-badge">#{{ car.id }}</span>
                    <span class="asset-title">{{ car.plate }}</span>
                    <button class="btn-edit" (click)="goEditCar(car.id)">‚úèÔ∏è</button>
                </div>
                <p class="asset-desc" *ngIf="car.description">{{ car.description }}</p>
                <div class="images-row" *ngIf="car.images && car.images.length > 0">
                    @for (img of car.images; track img.id) {
                    <div class="image-thumb" (click)="openLightbox(img.relativePath, img.fileName)">
                        <img [src]="'http://localhost:5005/uploads/' + img.relativePath" [alt]="img.fileName"
                            loading="lazy" />
                    </div>
                    }
                </div>
                <div class="no-images" *ngIf="!car.images || car.images.length === 0">
                    <span>{{ 'CUSTOMER_ASSETS_PAGE.NO_IMAGES' | translate }}</span>
                </div>
            </div>
            } @empty {
            <div class="empty-section">
                <p>{{ 'CUSTOMER_ASSETS_PAGE.NO_CARS' | translate }}</p>
            </div>
            }
        </div>
    </div>
</div>

<!-- Lightbox Overlay -->
<div class="lightbox-overlay" *ngIf="lightboxImage" (click)="closeLightbox()">
    <div class="lightbox-content" (click)="$event.stopPropagation()">
        <button class="lightbox-close" (click)="closeLightbox()">‚úï</button>
        <img [src]="lightboxImage" [alt]="lightboxAlt" />
        <p class="lightbox-caption">{{ lightboxAlt }}</p>
    </div>
</div>