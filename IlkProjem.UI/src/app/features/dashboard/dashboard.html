<div class="dashboard-wrapper">
  <div class="header-section">
  <div class="title-area">
    <h1>MÃ¼ÅŸteri YÃ¶netimi</h1>
    <p>Sistemde kayÄ±tlÄ± mÃ¼ÅŸterilerin listesi.</p>
  </div>
  <button class="btn-primary add-btn" (click) = "onAdd()">
    <span>+</span> Yeni MÃ¼ÅŸteri Ekle
  </button>
</div>

  <div class="customer-list-container">
    <div class="list-header">
      <span class="col-id">ID</span>
      <span class="col-name">MÃ¼ÅŸteri AdÄ±</span>
      <span class="col-email">E-posta</span>
      <span class="col-balance text-end">Bakiye</span>
      <span class="col-date">KayÄ±t Tarihi</span>
      <span class="col-actions text-center">Ä°ÅŸlemler</span>
    </div>

    @for (customer of customers; track customer.id) {
      <div class="list-card">
        <div class="col-id">
          <span class="id-badge">#{{ customer.id }}</span>
        </div>
        <div class="col-name">
          <span class="customer-name">{{ customer.name }}</span>
        </div>
        <div class="col-email">
          <span class="email-text">{{ customer.email }}</span>
        </div>
        <div class="col-balance text-end">
          <span class="balance-amount" [class.negative]="customer.balance < 0">
            {{ customer.balance | currency:'TRY':'symbol-narrow':'1.2-2' }}
          </span>
        </div>
        <div class="col-date">
          <span class="date-text">{{ customer.createdAt | date:'dd MMM yyyy' }}</span>
        </div>
        <div class="col-actions text-center">
          <button class="btn-icon edit" (click)="onEdit(customer)" title="DÃ¼zenle">âœï¸</button>
          <button class="btn-icon delete" (click)="onDelete(customer.id)" title="Sil">ğŸ—‘ï¸</button>
        </div>
      </div>
    } @empty {
      <div class="empty-state">
        <div class="empty-icon">ğŸ“</div>
        <p>GÃ¶rÃ¼ntÃ¼lenecek mÃ¼ÅŸteri bulunamadÄ±.</p>
      </div>
    }
  </div>
</div>

@if (isModalOpen) {
  <div class="modal-backdrop">
    <div class="modal-content">
      <div class="modal-header">
        <h2>MÃ¼ÅŸteriyi DÃ¼zenle</h2>
        <button class="btn-close" (click)="closeModal()">Ã—</button>
      </div>
      
      <form [formGroup]="updateForm" (ngSubmit)="onUpdate()">
        <div class="form-body">
          <div class="form-group">
            <label for="name">Ad Soyad</label>
            <input id="name" type="text" formControlName="name" 
                   [class.error]="updateForm.get('name')?.invalid && updateForm.get('name')?.touched"
                   placeholder="Ä°sim giriniz">
            @if (updateForm.get('name')?.invalid && updateForm.get('name')?.touched) {
              <small class="error-msg">GeÃ§erli bir isim girmelisiniz (Min 3 karakter).</small>
            }
          </div>
          
          <div class="form-group">
            <label for="email">E-posta Adresi</label>
            <input id="email" type="email" formControlName="email" 
                   [class.error]="updateForm.get('email')?.invalid && updateForm.get('email')?.touched"
                   placeholder="ornek@mail.com">
            @if (updateForm.get('email')?.invalid && updateForm.get('email')?.touched) {
              <small class="error-msg">LÃ¼tfen geÃ§erli bir e-posta adresi giriniz.</small>
            }
          </div>
          
          <div class="form-group">
            <label for="balance">Bakiye (TRY)</label>
            <input id="balance" type="number" formControlName="balance" placeholder="0.00">
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn-secondary" (click)="closeModal()">VazgeÃ§</button>
          <button type="submit" class="btn-primary" [disabled]="updateForm.invalid">
            DeÄŸiÅŸiklikleri Kaydet
          </button>
        </div>
      </form>
    </div>
  </div>
}

@if (isAddModalOpen) {
  <div class="modal-backdrop" (click)="isAddModalOpen = false">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>âœ¨ Yeni MÃ¼ÅŸteri Ekle</h2>
        <button class="btn-close" (click)="isAddModalOpen = false">Ã—</button>
      </div>
      
      <form [formGroup]="updateForm" (ngSubmit)="onCreate()">
        <div class="form-body">
          <div class="form-group">
            <label>Ad Soyad</label>
            <input type="text" formControlName="name" placeholder="Tam isim">
          </div>
          <div class="form-group">
            <label>E-posta</label>
            <input type="email" formControlName="email" placeholder="email@example.com">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-secondary" (click)="isAddModalOpen = false">VazgeÃ§</button>
          <button type="submit" class="btn-primary" [disabled]="updateForm.invalid">MÃ¼ÅŸteriyi Kaydet</button>
        </div>
      </form>
    </div>
  </div>
}